<!-- This file is for admin user manage page -->
{% extends "admin/base.html" %}

{% block admincontent %}
<!-- main body -->
    <div class="content">
        <div class="button-group">
            <a href="{{ url_for('admin.adduser') }}" class="button1">Add User</a>
        </div>
        <div>
            <h2 class="pagetitle">Manage Users</h2>
            {% for message in get_flashed_messages() %}
                <span class="flash">{{ message }}</span>
            {% endfor %}
            <table id="usertable">
                <thead>
                    <th>User Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th colspan="3">Action</th>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td>{{ user.username }} </td>
                        <td>{{ user.email }}</td>
                        <td>{% if user.admin == True %} Admin {% else %} User {% endif %}</td>
                        <td><button type="submit" name="edituser" class="edit" onclick="location.href=&quot;{{ url_for('admin.edituser', id=user.id)}}&quot;">edit</button></td>
                        <td><button type="submit" name="deleteuser" class="delete" onclick="location.href=&quot;{{ url_for('admin.deleteuser', id=user.id)}}&quot;">delete</button></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

{% block jsfiles %}
    <!-- js to achieve row delete-->
    <script>
        var index, table = document.getElementById('usertable');
        for(var i =1;i < table.rows.length;i++)
    {   
        table.rows[i].cells[4].onclick = function()
        {
            //'this' refers to the button which is the child of a table row
            index = this.parentElement.rowIndex;
            table.deleteRow(index);
        };
    }
    </script>
    {{ super() }}
{% endblock %}